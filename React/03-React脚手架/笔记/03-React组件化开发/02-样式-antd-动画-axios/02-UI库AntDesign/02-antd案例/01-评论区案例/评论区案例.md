åˆ©ç”¨`antd`ä¸­çš„ç»„ä»¶ï¼Œå®Œæˆä¸€ä¸ªè¯„è®ºåŒºdemoï¼Œå¦‚å›¾æ‰€ç¤ºï¼š

<img src="è¯„è®ºåŒºæ¡ˆä¾‹.assets/001.gif" alt="001" style="zoom:80%;" />

## ç»„ä»¶ç»“æ„

åœ¨å†™ä»£ç ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆè¦ç†æ¸…å„ä¸ªç»„ä»¶ä¹‹é—´çš„å…³ç³»ï¼Œç„¶åæ ¹æ®ä¸åŒçš„åŠŸèƒ½æ¨¡å—ï¼Œå°è£…æˆä¸åŒçš„ç»„ä»¶ã€‚

* ASCommpent
  * CommentInput
  * CommentItem

<img src="è¯„è®ºåŒºæ¡ˆä¾‹.assets/002.png" alt="002" style="zoom:65%;" />

## ç¼–å†™ä»£ç 

### ASCommpent

* æŒ‚è½½ä¸¤ä¸ªå­ç»„ä»¶
* ç»´æŠ¤`comments`çŠ¶æ€

```
import { PureComponent } from "react";
import styled from "styled-components";
import CommentItem from "./CommentItem";
import CommentInput from "./CommentInput";

//ç®€å•æ ·å¼ç¼–å†™
const StyleWrapper = styled.div`
  width: 300px;
  padding: 10px;
  border-radius: 3px;
`;

export default class ASComment extends PureComponent {
  constructor(props) {
    super(props);
    this.state = {
      comments: [],
    };
  }
  render() {
    const { comments } = this.state;
    return (
      <StyleWrapper id="ASComment">
        <CommentItem
          comments={comments}
          deleteComment={this.deleteComment.bind(this)}
        />
        <CommentInput submitComment={this.submitComment.bind(this)} />
      </StyleWrapper>
    );
  }
  //æäº¤è¯„è®º
  submitComment(content) {
    let newComments = [...this.state.comments];
    let time = Date.now();
    newComments.push({
      id: time,
      avatar:"imagePath",
      author: "Ashun",
      content,
      datetime: time,
    });
    this.setState({
      comments: newComments,
    });
  }
  //åˆ é™¤è¯„è®º
  deleteComment(index) {
    let newComments = [...this.state.comments];
    newComments.splice(index, 1);
    this.setState({
      comments: newComments,
    });
  }
}
```

### CommentInput

ä½¿ç”¨çš„`antd`ç»„ä»¶ï¼š`Input.TextArea`ã€`Button`

* å°†`Input.TextArea`è®¾ç½®ä¸ºå—æ§ç»„ä»¶
* ç‚¹å‡»æŒ‰é’®ï¼Œæ‰§è¡Œçˆ¶ç»„ä»¶çš„æäº¤é€»è¾‘ã€‚

```
import { PureComponent } from "react";
import { Button, Input } from "antd";
import styled from "styled-components";

const StyleWrapper = styled.div`
  margin-top: 10px;
  position: relative;
  button {
    margin: 5px;
    position: relative;
    bottom: 0px;
    right: 5px;
  }
`;
export default class CommentInput extends PureComponent {
  constructor(props) {
    super(props);
    this.state = {
      content: "",
      placeholder: "è¯·è¾“å…¥å†…å®¹",
    };
  }
  render() {
    const { content, placeholder } = this.state;
    return (
      <StyleWrapper id="CommentInput">
        <Input.TextArea
          value={content}
          onChange={(e) => this.handleChange(e)}
          placeholder={placeholder}
          rows={2}
        />
        <Button
          onClick={() => this.submitComment()}
          type="primary"
          size="small"
          shape="round"
        >
          æäº¤
        </Button>
      </StyleWrapper>
    );
  }
  handleChange(event) {
    this.setState({
      content: event.target.value,
    });
    console.log(this.state.content);
  }
  submitComment() {
    this.props.submitComment(this.state.content);
    this.setState({
      content: "",
    });
  }
}
```

### CommentItem

ä½¿ç”¨çš„`antd`ç»„ä»¶ï¼š`Comment`ã€`Tooltip`ã€å›¾æ ‡åº“

* ç‚¹å‡»åˆ é™¤æŒ‰é’®ï¼Œæ‰§è¡Œçˆ¶ç»„ä»¶çš„åˆ é™¤é€»è¾‘ã€‚
* `Comment`ç»„ä»¶å¸¸ç”¨å±æ€§
  * authorï¼šç”¨æˆ·å
  * avatarï¼šç”¨æˆ·å¤´åƒ
  * contentï¼šè¯„è®ºå†…å®¹
  * datetimeï¼šæ—¶é—´
* å…³äºdatetimeå±æ€§ï¼Œè¿™é‡Œåˆåœ¨å…¶ä¸­æ’å…¥äº†`Tooltip`ç»„ä»¶ï¼Œé»˜è®¤å±•ç¤ºè·ç¦»å½“å‰çš„æ—¶é—´ï¼Œå½“é¼ æ ‡ hover æ—¶ï¼Œä¼šæœ‰æç¤ºæ°”æ³¡æ˜¾ç¤ºå…·ä½“çš„æ—¶é—´ã€‚
* æ—¶é—´çš„æ˜¾ç¤ºï¼Œä½¿ç”¨äº†`moment`åº“ï¼Œä¾¿äºä½¿ç”¨ã€‚

```
import { PureComponent } from "react";
import { Comment, Tooltip } from "antd";
import { DeleteOutlined } from "@ant-design/icons";
import styled from "styled-components";
import moment from "moment";

const StyleWrapper = styled.div`
  position: relative;
  span.delete {
    font-size: 12px;
    position: absolute;
    bottom: 0px;
    right: 10px;
  }
`;
export default class CommentItem extends PureComponent {
  render() {
    const { comments } = this.props;
    return (
      <StyleWrapper id="CommentItem">
        {comments.map((item, key) => (
          <Comment
            key={item.id}
            author={item.author}
            avatar={item.avatar}
            content={item.content}
            datetime={
              <Tooltip
                title={moment(item.datetime).format("YYYY-MM-DD HH:mm:ss")}
              >
                {/* è¯„è®ºè·ç¦»å½“å‰çš„æ—¶é—´ */}
                <span>{moment(item.datetime).fromNow()}</span>
              </Tooltip>
            }
          >
            <span
              className="delete"
              onClick={() => {
                this.deleteComment(key);
              }}
            >
              <DeleteOutlined />
              åˆ é™¤
            </span>
          </Comment>
        ))}
      </StyleWrapper>
    );
  }
  deleteComment(index) {
    this.props.deleteComment(index);
  }
}
```

`moment`æ—¶é—´åº“é»˜è®¤æ˜¾ç¤ºä¸ºè‹±æ–‡ï¼Œå¦‚æœæƒ³æ˜¾ç¤ºä¸­æ–‡ï¼Œåœ¨å…¥å£æ–‡ä»¶å…¨å±€è®¾ç½®`moment`æ—¶åŒºå³å¯ã€‚

<img src="è¯„è®ºåŒºæ¡ˆä¾‹.assets/004.png" alt="004" style="zoom:80%;" />

```
//index.js
import "moment/locale/zh-cn";//ä¸­å›½æ—¶åŒº
```

## åŸç”ŸReactå®ç°

åé¢æˆ‘åˆä½¿ç”¨åŸç”ŸReactå®ç°äº†ä¸€ä¸‹ï¼Œå…¶å®è¿‡ç¨‹å’Œä¸Šæ–‡ä¸€æ ·ï¼Œåªä¸è¿‡ç»„ä»¶éœ€è¦è‡ªå·±å°è£…ã€æ ·å¼éœ€è¦æˆ‘ä»¬è‡ªå·±è°ƒï¼ŒçœŸæ­£çš„é€»è¾‘ä»£ç æ˜¯æ²¡æœ‰åŒºåˆ«çš„ã€‚

æœ€ç»ˆå®ç°æ•ˆæœå¯¹æ¯”ï¼ˆå·¦ä¾§åŸç”ŸReactå®ç°ï¼‰ï¼š

<img src="è¯„è®ºåŒºæ¡ˆä¾‹.assets/003.gif" alt="003" style="zoom:80%;" />

### ASCommpent

`ASCommpent`æ˜¯è¯„è®ºåŠŸèƒ½çš„æ ¹ç»„ä»¶ï¼Œå®ç°è¿‡ç¨‹ä¸ä¸Šæ–‡ä¸€æ¨¡ä¸€æ ·ï¼Œå› ä¸ºè¯¥ç»„ä»¶åªæ˜¯ç”¨äºï¼š

* æŒ‚è½½ä¸¤ä¸ªå­ç»„ä»¶
* ç»´æŠ¤`comments`çŠ¶æ€

### CommentInput

**æ ·å¼ä»£ç **

```
import styled from "styled-components";
const StyleWrapper = styled.div`
  margin-top: 10px;
  textarea {
    width: 100%;
    outline: none;
    border-color: #ddd;
    padding: 5px 8px;
    &:focus {
      border: 1px solid skyblue;
    }
  }
  button {
    padding: 2px 20px;
    color: white;
    border-radius: 25px;
    border: none;
    background-color: skyblue;
  }
`; 
export default StyleWrapper ;
```

**é€»è¾‘ä»£ç **

```
import { PureComponent } from "react";
import StyleWrapper from "./CommentInputStyled.js";

export default class CommentInput extends PureComponent {
  constructor(props) {
    super(props);
    this.state = {
      content: "",
      placeholder: "è¯·è¾“å…¥å†…å®¹",
    };
  }
  render() {
    const { content, placeholder } = this.state;
    return (
      <StyleWrapper id="CommentInput">
        <div className="inputBox">
          <textarea
            value={content}
            onChange={(e) => this.handleChange(e)}
            placeholder={placeholder}
            rows={2}
          />
        </div>
        <button onClick={() => this.submitComment()}>æäº¤</button>
      </StyleWrapper>
    );
  }
  handleChange(event) {
    this.setState({
      content: event.target.value,
    });
    console.log(this.state.content);
  }
  submitComment() {
    this.props.submitComment(this.state.content);
    this.setState({
      content: "",
    });
  }
}
```

### CommentItem

**æ ·å¼ä»£ç **

```
import styled from "styled-components";
const StyleWrapper = styled.div`
  padding: 5px 5px;
  header {
    width: 100%;
    display: flex;
    flex-direction: row;
    overflow: hidden;
    .avatar {
      height: 32px;
      width: 32px;
      margin-right: 8px;
      border-radius: 50%;
      overflow: hidden;
      img {
        width: 100%;
      }
    }
    .info {
      flex: 1;
      color: rgba(0, 0, 0, 0.45);
      .author {
        font-size: 12px;
        margin-right: 5px;
      }
      .datetime {
        font-size: 12px;
      }
    }
  }
  main {
    margin-top: -8px;
    padding: 0px 0px 5px 40px;
    width: 100%;
    p {
      margin: 0px;
    }
  }
  footer {
    width: 100%;
    height: 20px;
    position: relative;
    font-size: 12px;
    .delete {
      line-height: 20px;
      width: 50px;
      height: 100%;
      position: absolute;
      right: 5px;
      text-align: center;
    }
  }
`;
export default StyleWrapper ;
```

**é€»è¾‘ä»£ç **

```
import moment from "moment";
import { PureComponent } from "react";
import StyleWrapper from "./CommentItemStyled.js";

export default class CommentItem extends PureComponent {
  render() {
    const { comments } = this.props;
    return (
      <StyleWrapper id="CommentItemWrapper">
        {comments.map((item, key) => {
          return (
            <div className="CommentItems" key={item.id}>
              <header>
                <div className="avatar">
                  <img alt="avatar" src={item.avatar} />
                </div>
                <div className="info">
                  <span className="author">{item.author}</span>
                  <span className="datetime">
                    {moment(item.datetime).format("MM/DD hh:mm")}
                  </span>
                </div>
              </header>
              <main>
                <p className="content">{item.content}</p>
              </main>
              <footer>
                <div className="delete" onClick={() => this.deleteComment(key)}>
                  ğŸš®åˆ é™¤
                </div>
              </footer>
            </div>
          );
        })}
      </StyleWrapper>
    );
  }
  deleteComment(index) {
    this.props.deleteComment(index);
  }
}
```

