# vuex的响应式原理

---

### 原理：
​	我们知道，vuex是多界面状态管理工具，当通过actions、mutations改变state时，数据变动是响应式的，会将改变后的数据渲染到view上。

但是实现state响应式有一个前提:

> 改变的state,必须是在vuex实例化类中提前配置、初始化好的数据。
>
> 默认情况下，只有提前在vuex.state中配置好的状态发生改变时才能实现响应式。
>
> 这是因为，**这些提前配置好的state，已经被加入到了vuex内部的响应系统中，响应系统会监听这些state的改变，并实现响应式。**





### 不能实现响应式的情况：

---

改变数据，不能实现响应式，一般有两种情况：

>**这些情况一般应用于state为 Array | Object时，因为可以在后期对其进行增删改 元素 | 属性：**
>
>1. Array
>
>   当进行增删改元素时，**直接通过下标操作，是不能实现响应式的**
>
>2. Object
>
>   当进行属性的修改时，能够实现响应式，因为这些属性已经提前初始化在vuex.state中了。
>
>   **但是当增加属性时候，是后期添加的属性，不能实现响应式。**
>
>   **删除提前配置好的属性，也不能实现响应式**

1. 后期外部添加的state

   > 如果state为Array | Object, 后期通过外部添加的 元素 | 属性，虽然能够成功添加，但是这些state默认情况下，是不能实现响应式的。必须使用vue提供的API才能实现响应式

   

2. 后期在外部删除已经初始化的state

   >如果state为Array | Object, 
   >
   >1. Array
   >
   >   >之前在学习v-for时，就提到过vue默认支持响应式的原生Array的方法
   >   >
   >   >* push()
   >   >* pop()
   >   >* unshift()
   >   >* shift()
   >   >* splic()
   >   >* sort()
   >   >* reserve()
   >   >
   >   >如果直接通过下标操作Array，是不能实现数据的响应式的。
   >
   >2. Object
   >
   >   >后期在外部通过原生Js语法（delete  obj.属性名  ）删除obj的属性，虽然能够成功删除，但是不能实现数据响应式





### 问题的解决：

---

**使用Vue提供的API**，对Array、Object进行操作。

1. Vue.set(arr | obj, index | key ,更改值)；

   >Vue.set可以在对应 下标|属性名 增加、修改值。
   >
   >如果原 下标|属性名 存在数据，则进行修改。
   >
   >否则为增加

2. Vue.delete(arr | obj, index | key)；

   >删除  下标|属性名 对应的元素



​	**这两个API，是Vue提供的，不依赖于vuex，在原生Vue中也可使用**

